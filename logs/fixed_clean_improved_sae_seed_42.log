INFO:experimental_framework:Created subset with 6000 samples for classes {2, 3, 4, 5, 6, 7}
INFO:experimental_framework:Class distribution: {2: 1000, 3: 1000, 4: 1000, 5: 1000, 6: 1000, 7: 1000}
INFO:experimental_framework:Created subset with 6000 samples for classes {0, 1, 2, 3, 4, 5}
INFO:experimental_framework:Class distribution: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 1000}
INFO:experimental_framework:Created subset with 1200 samples for classes {2, 3, 4, 5, 6, 7}
INFO:experimental_framework:Class distribution: {2: 200, 3: 200, 4: 200, 5: 200, 6: 200, 7: 200}
INFO:experimental_framework:Created subset with 1200 samples for classes {0, 1, 2, 3, 4, 5}
INFO:experimental_framework:Class distribution: {0: 200, 1: 200, 2: 200, 3: 200, 4: 200, 5: 200}
INFO:experimental_framework:Epoch 1/5: Loss = 1.1788, Accuracy = 0.8975
INFO:experimental_framework:Epoch 2/5: Loss = 0.4460, Accuracy = 0.9250
INFO:experimental_framework:âœ“ Model achieved required accuracy 0.9250 >= 0.9
INFO:experimental_framework:Epoch 1/5: Loss = 0.5612, Accuracy = 0.9542
INFO:experimental_framework:âœ“ Model achieved required accuracy 0.9542 >= 0.9
INFO:neural_concept_transfer:Source classes S_B: {2, 3, 4, 5, 6, 7}
INFO:neural_concept_transfer:Target classes S_A: {0, 1, 2, 3, 4, 5}
INFO:neural_concept_transfer:Shared classes S_shared: {2, 3, 4, 5}
INFO:neural_concept_transfer:Transfer classes: {6, 7}
INFO:improved_sae_robust_transfer:ðŸ”§ Initialized Improved SAE Integration System
INFO:improved_sae_robust_transfer:   - Target feature dimension: 64
INFO:improved_sae_robust_transfer:   - Trainable integration weights: 64 parameters
INFO:improved_sae_robust_transfer:   - Trainable injection strength: 1 parameter
INFO:improved_sae_robust_transfer:   - Total new parameters: 65
INFO:improved_sae_robust_transfer:   - Replaces: Single rho blending parameter
INFO:neural_concept_transfer:=== Fitting Neural Concept Transfer System ===
INFO:neural_concept_transfer:Step 1: Training Sparse Autoencoders
INFO:neural_concept_transfer:Training source SAE...
INFO:neural_concept_transfer:SAE Epoch 0: Loss = 0.0818
INFO:neural_concept_transfer:SAE Epoch 20: Loss = 0.0052
INFO:neural_concept_transfer:SAE Epoch 40: Loss = 0.0055
INFO:neural_concept_transfer:Training target SAE...
INFO:neural_concept_transfer:SAE Epoch 0: Loss = 0.0692
INFO:neural_concept_transfer:SAE Epoch 20: Loss = 0.0103
INFO:neural_concept_transfer:SAE Epoch 40: Loss = 0.0088
INFO:neural_concept_transfer:Step 2: Extracting concept centroids
INFO:neural_concept_transfer:Class 2: 1000 samples
INFO:neural_concept_transfer:Class 3: 1000 samples
INFO:neural_concept_transfer:Class 4: 1000 samples
INFO:neural_concept_transfer:Class 5: 1000 samples
INFO:neural_concept_transfer:Class 6: 1000 samples
INFO:neural_concept_transfer:Class 7: 1000 samples
INFO:neural_concept_transfer:Class 0: 1000 samples
INFO:neural_concept_transfer:Class 1: 1000 samples
INFO:neural_concept_transfer:Class 2: 1000 samples
INFO:neural_concept_transfer:Class 3: 1000 samples
INFO:neural_concept_transfer:Class 4: 1000 samples
INFO:neural_concept_transfer:Class 5: 1000 samples
INFO:neural_concept_transfer:Step 3: Fitting Orthogonal Procrustes alignment
INFO:neural_concept_transfer:Procrustes alignment error: 0.1828
INFO:neural_concept_transfer:Step 4: Discovering free space
INFO:neural_concept_transfer:Used space rank: 6, Free dimensions: 8
INFO:neural_concept_transfer:System fitted successfully: {'alignment_error': np.float32(0.182809), 'concept_dim': 24, 'n_shared_classes': 4, 'n_transfer_classes': 2, 'free_dimensions': 6}
INFO:improved_sae_robust_transfer:Setting up IMPROVED SAE injection for class 6
INFO:improved_sae_robust_transfer:Training IMPROVED SAE injection system...
INFO:improved_sae_robust_transfer:IMPROVED SAE injection training for class 6
INFO:improved_sae_robust_transfer:   - Training steps: 50 (same as parent)
INFO:improved_sae_robust_transfer:   - Learning rate: 0.006 (same as parent)
INFO:improved_sae_robust_transfer:   - Optimizing: 9 injection params + 65 SAE params
INFO:improved_sae_robust_transfer:IMPROVED SAE step 0: Loss = 4.6900
INFO:improved_sae_robust_transfer:   Transfer Loss: 4.6716, Preservation Loss: 0.1835
INFO:improved_sae_robust_transfer:   Blend weights range: [0.498, 0.502]
INFO:improved_sae_robust_transfer:   Mean blend weight: 0.500
INFO:improved_sae_robust_transfer:   Injection strength: 0.711
INFO:improved_sae_robust_transfer:IMPROVED SAE step 10: Loss = 5.0034
INFO:improved_sae_robust_transfer:   Transfer Loss: 4.9960, Preservation Loss: 0.0743
INFO:improved_sae_robust_transfer:   Blend weights range: [0.484, 0.516]
INFO:improved_sae_robust_transfer:   Mean blend weight: 0.498
INFO:improved_sae_robust_transfer:   Injection strength: 0.711
INFO:improved_sae_robust_transfer:IMPROVED SAE step 20: Loss = 4.9761
INFO:improved_sae_robust_transfer:   Transfer Loss: 4.9532, Preservation Loss: 0.2295
INFO:improved_sae_robust_transfer:   Blend weights range: [0.469, 0.530]
INFO:improved_sae_robust_transfer:   Mean blend weight: 0.496
INFO:improved_sae_robust_transfer:   Injection strength: 0.711
INFO:improved_sae_robust_transfer:IMPROVED SAE step 30: Loss = 4.5612
INFO:improved_sae_robust_transfer:   Transfer Loss: 4.5537, Preservation Loss: 0.0749
INFO:improved_sae_robust_transfer:   Blend weights range: [0.456, 0.545]
INFO:improved_sae_robust_transfer:   Mean blend weight: 0.494
INFO:improved_sae_robust_transfer:   Injection strength: 0.711
INFO:improved_sae_robust_transfer:IMPROVED SAE step 40: Loss = 5.2526
INFO:improved_sae_robust_transfer:   Transfer Loss: 5.2217, Preservation Loss: 0.3087
INFO:improved_sae_robust_transfer:   Blend weights range: [0.442, 0.559]
INFO:improved_sae_robust_transfer:   Mean blend weight: 0.492
INFO:improved_sae_robust_transfer:   Injection strength: 0.711
INFO:improved_sae_robust_transfer:âœ… IMPROVED SAE injection training completed
INFO:improved_sae_robust_transfer:ROBUST adaptation for class 6
INFO:robust_balanced_transfer:Starting ROBUST adaptation for class 6
INFO:robust_balanced_transfer:ROBUST adaptation with 45 samples
INFO:robust_balanced_transfer:ROBUST stage 1: lr=0.003, reg=0.05
INFO:robust_balanced_transfer:Stage 1 Step 0: Adaptation=4.9849, Preservation=0.9655, Effectiveness=0.0000, Balanced Score=0.4000
INFO:robust_balanced_transfer:ðŸŽ¯ NEW BEST robust score: 0.4000
INFO:robust_balanced_transfer:Stage 1 Step 5: Adaptation=4.1633, Preservation=0.9658, Effectiveness=0.0000, Balanced Score=0.4000
INFO:robust_balanced_transfer:Stage 1 Step 10: Adaptation=3.3546, Preservation=0.9663, Effectiveness=0.0000, Balanced Score=0.4000
INFO:robust_balanced_transfer:Stage 1 Step 15: Adaptation=2.5720, Preservation=0.9668, Effectiveness=0.0000, Balanced Score=0.4000
INFO:robust_balanced_transfer:Stage 1 Step 20: Adaptation=1.8415, Preservation=0.9667, Effectiveness=0.0230, Balanced Score=0.4197
INFO:robust_balanced_transfer:ðŸŽ¯ NEW BEST robust score: 0.4197
INFO:robust_balanced_transfer:ROBUST stage 2: lr=0.002, reg=0.03
INFO:robust_balanced_transfer:Stage 2 Step 0: Adaptation=1.2055, Preservation=0.9615, Effectiveness=0.2180, Balanced Score=0.5869
INFO:robust_balanced_transfer:ðŸŽ¯ NEW BEST robust score: 0.5869
INFO:robust_balanced_transfer:Stage 2 Step 5: Adaptation=0.8564, Preservation=0.9433, Effectiveness=0.5000, Balanced Score=0.8286
INFO:robust_balanced_transfer:ðŸŽ¯ NEW BEST robust score: 0.8286
INFO:robust_balanced_transfer:Stage 2 Step 10: Adaptation=0.5809, Preservation=0.8710, Effectiveness=0.7830, Balanced Score=1.0000
INFO:robust_balanced_transfer:ðŸŽ¯ NEW BEST robust score: 1.0000
INFO:robust_balanced_transfer:âœ… Requirements met! Preservation=0.8710, Effectiveness=0.7830
INFO:robust_balanced_transfer:Stage 2 Step 15: Adaptation=0.3787, Preservation=0.4618, Effectiveness=0.9800, Balanced Score=0.8309
INFO:robust_balanced_transfer:Stage 2 Step 20: Adaptation=0.2397, Preservation=0.1572, Effectiveness=1.0000, Balanced Score=0.6786
INFO:robust_balanced_transfer:ROBUST stage 3: lr=0.0015, reg=0.02
INFO:robust_balanced_transfer:Stage 3 Step 0: Adaptation=0.1492, Preservation=0.1503, Effectiveness=1.0000, Balanced Score=0.6752
INFO:robust_balanced_transfer:Stage 3 Step 5: Adaptation=0.1032, Preservation=0.1487, Effectiveness=1.0000, Balanced Score=0.6743
INFO:robust_balanced_transfer:Stage 3 Step 10: Adaptation=0.0723, Preservation=0.1463, Effectiveness=1.0000, Balanced Score=0.6732
INFO:robust_balanced_transfer:Stage 3 Step 15: Adaptation=0.0524, Preservation=0.1445, Effectiveness=1.0000, Balanced Score=0.6723
INFO:robust_balanced_transfer:Stage 3 Step 20: Adaptation=0.0397, Preservation=0.1437, Effectiveness=1.0000, Balanced Score=0.6718
INFO:robust_balanced_transfer:ROBUST stage 4: lr=0.001, reg=0.01
INFO:robust_balanced_transfer:Stage 4 Step 0: Adaptation=0.0315, Preservation=0.1425, Effectiveness=1.0000, Balanced Score=0.6713
INFO:robust_balanced_transfer:Stage 4 Step 5: Adaptation=0.0245, Preservation=0.1408, Effectiveness=1.0000, Balanced Score=0.6704
INFO:robust_balanced_transfer:Stage 4 Step 10: Adaptation=0.0194, Preservation=0.1398, Effectiveness=1.0000, Balanced Score=0.6699
INFO:robust_balanced_transfer:Stage 4 Step 15: Adaptation=0.0156, Preservation=0.1387, Effectiveness=1.0000, Balanced Score=0.6693
INFO:robust_balanced_transfer:Stage 4 Step 20: Adaptation=0.0130, Preservation=0.1382, Effectiveness=1.0000, Balanced Score=0.6691
INFO:robust_balanced_transfer:ROBUST stage 5: lr=0.0008, reg=0.005
INFO:robust_balanced_transfer:Stage 5 Step 0: Adaptation=0.0111, Preservation=0.1377, Effectiveness=1.0000, Balanced Score=0.6688
INFO:robust_balanced_transfer:Stage 5 Step 5: Adaptation=0.0091, Preservation=0.1357, Effectiveness=1.0000, Balanced Score=0.6678
INFO:robust_balanced_transfer:Stage 5 Step 10: Adaptation=0.0075, Preservation=0.1347, Effectiveness=1.0000, Balanced Score=0.6673
INFO:robust_balanced_transfer:Stage 5 Step 15: Adaptation=0.0064, Preservation=0.1332, Effectiveness=1.0000, Balanced Score=0.6666
INFO:robust_balanced_transfer:Stage 5 Step 20: Adaptation=0.0055, Preservation=0.1322, Effectiveness=1.0000, Balanced Score=0.6661
INFO:robust_balanced_transfer:âœ… ROBUST adaptation completed!
INFO:robust_balanced_transfer:   Final Preservation: 0.8710
INFO:robust_balanced_transfer:   Final Effectiveness: 0.7830
INFO:robust_balanced_transfer:   Balanced Score: 1.0000
INFO:robust_balanced_transfer:ðŸŽ‰ ROBUST SUCCESS: Both requirements achieved!
